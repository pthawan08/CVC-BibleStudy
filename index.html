<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen relative">

    <div class="absolute top-4 right-4 z-10">
        <a href="checkin.html" class="bg-white border border-[#C5A66B] text-[#C5A66B] px-4 py-2 rounded-lg shadow-sm hover:bg-[#C5A66B] hover:text-white transition font-bold text-sm flex items-center gap-2">
            <span>üìù</span> ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </a>
    </div>

    <div class="max-w-2xl mx-auto bg-white shadow-xl rounded-lg overflow-hidden my-10 relative">
        <div class="bg-[#C5A66B] p-6 text-center text-white pt-12 md:pt-6">
            <h1 class="text-2xl font-bold">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ</h1>
            <p class="mt-2 text-sm opacity-90">‡∏Ç‡∏≠‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏£‡∏∞‡∏ß‡∏à‡∏ô‡∏∞</p>
        </div>

        <div class="p-8">
            <form id="regisForm" class="space-y-6">
                
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h3>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                        <input type="text" name="name" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2 focus:border-[#C5A66B] focus:ring-[#C5A66B] outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">‡πÄ‡∏û‡∏®</label>
                            <select name="gender" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2">
                                <option>‡∏ä‡∏≤‡∏¢</option>
                                <option>‡∏´‡∏ç‡∏¥‡∏á</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠ (‡∏õ‡∏µ)</label>
                            <input type="text" name="faithAge" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2 ‡∏õ‡∏µ">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏à‡∏±‡∏Å‡∏£</label>
                        <input type="text" name="church" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2" placeholder="‡πÄ‡∏ä‡πà‡∏ô CVC ‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å">
                    </div>
                </div>

                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                    
                    <div class="flex items-center space-x-6">
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="studyType" value="full" checked onclick="toggleSubjects(false)" class="text-[#C5A66B] focus:ring-[#C5A66B]">
                            <span class="ml-2">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="studyType" value="subject" onclick="toggleSubjects(true)" class="text-[#C5A66B] focus:ring-[#C5A66B]">
                            <span class="ml-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</span>
                        </label>
                    </div>

                    <div id="subjectList" class="hidden bg-gray-50 p-4 rounded-md border space-y-2">
                        <p class="text-sm text-gray-500 mb-2 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</p>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏¥‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏ô" class="mr-2 text-[#C5A66B] rounded"> 1. ‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏¥‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏ô</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏£‡∏∞‡∏Ñ‡∏±‡∏°‡∏†‡∏µ‡∏£‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô" class="mr-2 text-[#C5A66B] rounded"> 2. ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏£‡∏∞‡∏Ñ‡∏±‡∏°‡∏†‡∏µ‡∏£‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏°‡∏±‡∏™‡∏Å‡∏≤‡∏£" class="mr-2 text-[#C5A66B] rounded"> 3. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏°‡∏±‡∏™‡∏Å‡∏≤‡∏£</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡∏ß‡∏¥‡∏ñ‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ñ‡∏£‡∏¥‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏ô" class="mr-2 text-[#C5A66B] rounded"> 4. ‡∏ß‡∏¥‡∏ñ‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ñ‡∏£‡∏¥‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏ô</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤" class="mr-2 text-[#C5A66B] rounded"> 5. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô" class="mr-2 text-[#C5A66B] rounded"> 6. ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï" class="mr-2 text-[#C5A66B] rounded"> 7. ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏≠‡∏†‡∏¥‡∏ö‡∏≤‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô" class="mr-2 text-[#C5A66B] rounded"> 8. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏≠‡∏†‡∏¥‡∏ö‡∏≤‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</label>
                        <label class="flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded"><input type="checkbox" name="subjects" value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏à‡∏±‡∏Å‡∏£" class="mr-2 text-[#C5A66B] rounded"> 9. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏à‡∏±‡∏Å‡∏£</label>
                    </div>
                </div>

                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">3. ‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
                    <div class="bg-[#FDF6E9] p-5 rounded-lg border border-[#E8DCC3] text-center shadow-sm">
                        <p class="font-bold text-lg text-[#8B6E3D]">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå</p>
                        
                        <div class="my-3">
                            <p class="text-4xl font-bold select-all text-gray-800 tracking-wider">428-177789-8</p>
                        </div>

                        <div class="text-sm text-gray-600 bg-white/50 p-2 rounded inline-block">
                            <span class="font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</span><br>
                            ‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤ ‡∏ô‡∏≤‡∏ó‡∏®‡∏¥‡πÇ‡∏£‡∏£‡∏±‡∏ï‡∏ô‡πå<br>
                            ‡∏™‡∏∏‡∏ò‡∏≤‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏®‡∏£‡∏µ‡∏ó‡∏≠‡∏á<br>
                            ‡∏≠‡∏±‡∏ç‡∏ä‡∏•‡∏µ ‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏∏‡∏Ç
                        </div>
                        
                        <div class="mt-4">
                            <button type="button" onclick="copyAccount()" class="text-xs bg-white border border-[#C5A66B] text-[#C5A66B] px-4 py-2 rounded-full hover:bg-[#C5A66B] hover:text-white transition flex items-center gap-1 mx-auto">
                                üìã ‡∏Å‡∏î‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô <span class="text-red-500">*</span></label>
                        <input type="file" id="slipFile" accept="image/*" required class="block w-full text-sm text-gray-500 file:mr-4 file:py-2.5 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[#C5A66B] file:text-white hover:file:bg-[#A68A55] cursor-pointer bg-gray-50 rounded-full border border-gray-200"/>
                    </div>
                </div>

                <button type="submit" id="submitBtn" class="w-full bg-gray-800 text-white py-4 rounded-lg font-bold text-lg shadow-lg hover:bg-gray-900 transition flex justify-center items-center transform active:scale-95">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                </button>
            </form>
        </div>
    </div>

    <script>
        // ******************************************************************
        // üî¥üî¥ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì Deploy ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üî¥üî¥
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbx2PV3P8zDm3-9RsdkY56HMlDmpGprQZ53EBCqHchskUzALNd7QqU1n51XFFOQvER1j/exec"; 
        // ******************************************************************

        function toggleSubjects(show) {
            const list = document.getElementById('subjectList');
            if(show) list.classList.remove('hidden');
            else list.classList.add('hidden');
        }

        function copyAccount() {
            navigator.clipboard.writeText("428-177789-8");
            Swal.fire({ 
                icon: 'success', 
                title: '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß', 
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 2000 
            });
        }

        document.getElementById('regisForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            const originalText = btn.innerHTML;
            
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
            btn.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
            `;
            btn.disabled = true;
            btn.classList.add('opacity-75', 'cursor-not-allowed');

            try {
                // 1. ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Form
                const formData = new FormData(this);
                const data = Object.fromEntries(formData);
                
                // 2. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Checkbox ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤
                const checkboxes = document.querySelectorAll('input[name="subjects"]:checked');
                let subjects = [];
                if(data.studyType === 'full') {
                    subjects = ["‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ (‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤)"];
                } else {
                    checkboxes.forEach((cb) => subjects.push(cb.value));
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ï‡∏¥‡πä‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏•‡∏¢ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                    if(subjects.length === 0) {
                        throw new Error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ß‡∏¥‡∏ä‡∏≤");
                    }
                }
                data.subjects = subjects;

                // 3. ‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô Base64
                const fileInput = document.getElementById('slipFile');
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB)
                    if(file.size > 5 * 1024 * 1024) {
                        throw new Error("‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB)");
                    }

                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = function () {
                        data.slipImage = reader.result; // ‡πÑ‡∏î‡πâ String ‡∏¢‡∏≤‡∏ß‡πÜ
                        sendData(data, btn, originalText);
                    };
                    reader.onerror = function (error) {
                        throw new Error("‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
                    };
                } else {
                    // ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ (‡∏õ‡∏Å‡∏ï‡∏¥ required ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡∏´‡∏•‡∏∏‡∏î‡∏°‡∏≤)
                    sendData(data, btn, originalText);
                }

            } catch (error) {
                showError(error.message);
                resetButton(btn, originalText);
            }
        });

        function sendData(data, btn, originalText) {
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ URL ‡∏ñ‡∏π‡∏Å‡πÉ‡∏™‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
            if(WEB_APP_URL.includes("‡∏ß‡∏≤‡∏á_URL")) {
                showError("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Web App URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏ü‡∏•‡πå index.html ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
                resetButton(btn, originalText);
                return;
            }

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ fetch
            fetch(WEB_APP_URL, {
                method: 'POST',
                // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏ä‡πâ text/plain ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏ö CORS Policy
                headers: { "Content-Type": "text/plain;charset=utf-8" },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(response => {
                if(response.result === 'success') {
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!',
                        text: '‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏Ñ‡∏£‡∏±‡∏ö',
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                        confirmButtonColor: '#C5A66B'
                    }).then(() => {
                        window.location.reload();
                    });
                } else {
                    throw new Error(response.error || response.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡∏ù‡∏±‡πà‡∏á Server");
                }
            })
            .catch(error => {
                console.error(error);
                showError("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + error.message);
                resetButton(btn, originalText);
            });
        }

        function showError(msg) {
            Swal.fire({
                icon: 'error',
                title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                text: msg,
                confirmButtonColor: '#374151'
            });
        }

        function resetButton(btn, originalText) {
            btn.disabled = false;
            btn.innerHTML = originalText;
            btn.classList.remove('opacity-75', 'cursor-not-allowed');
        }
    </script>
</body>
</html>